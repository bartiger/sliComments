window.addEvent("domready",function(){$$(".comments_form.no-js").removeClass("no-js");var f=document.id("comments_form_textarea"),e=document.id("comments-remaining-count"),g=function(){remaining_chars=500-this.value.length;e.set("text",remaining_chars);remaining_chars<=5?(e.setStyle("color","#900"),remaining_chars<0&&this.form.getElement("button").set("disabled",!0)):(this.form.getElement("button").set("disabled",!1),e.setStyle("color",null))};f.addEvents({keypress:g,focus:function(){this.addClass("init")},
blur:function(){this.value.length==0&&this.removeClass("init");g.call(this)}});"placeholder"in document.createElement("input")?$$(".comments_form_inputs li label").setStyle("display","none"):(OverText.implement({attach:function(){var b=this.element,c=this.options,d=c.textOverride||b.get("placeholder")||b.get("alt")||b.get("title");if(!d)return this;d=this.text=(b.getPrevious(c.element)||(new Element(c.element)).inject(b,"after")).addClass(c.labelClass).setStyles({lineHeight:"normal",position:"absolute",
cursor:"text"}).set("html",d).addEvent("click",this.hide.pass(c.element=="label",this));c.element=="label"&&(b.get("id")||b.set("id","input_"+String.uniqueID()),d.set("for",b.get("id")));if(c.wrap)this.textHolder=(new Element("div.overTxtWrapper",{styles:{lineHeight:"normal",position:"relative"}})).grab(d).inject(b,"before");return this.enable()}}),new OverText(f,{positionOptions:{offset:{x:6,y:6}}}),new OverText(document.id("comments_form_name")),new OverText(document.id("comments_form_email")));
document.id("comments_form_send").addEvent("click",function(b){b.stop();var c=this.form,d=function(a){typeof a=="string"&&console.log(a)};(new Request({url:this.form.get("action")+"&format=json",method:"post",data:"article_id="+this.form.article_id.value+"&name="+this.form.name.value+"&email="+this.form.email.value+"&text="+this.form.text.value+"&"+this.form.getElement("input[type=hidden]").get("name")+"=1",onRequest:function(){},onSuccess:function(a){a=JSON.decode(a);a.success?(a=a.data,(new Element("li.comment",
{html:'<div class="comment-body"><div class="profile-image-container"><img class="profile-image" src="//www.gravatar.com/avatar/'+a.email+'?s=40" alt="'+a.name+'"></div><div class="content-container"><div class="content"><div class="author">'+a.name+':</div><div class="comment-text">'+a.text+'</div></div></div></div><div class="clr"></div>'})).inject(document.id("comments_list"),"top"),a=document.id("comments_counter"),a.set("text",a.get("text").toInt()+1),c.reset(),c.text.removeClass("init").fireEvent("keypress"),
OverText.update()):d(a.error)},onFailure:d})).send()})});